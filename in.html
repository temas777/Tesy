<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>–¢—Ä–µ–Ω–∞–∂—ë—Ä –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
    /* –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è */
    
    /* –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –ê–ù–ò–ú–ê–¶–ò–ò –ü–û–ë–ï–î–´ */
    .victory-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      flex-direction: column;
    }
    
    .victory-message {
      background: rgba(255,255,255,0.95);
      padding: 20px;
      border-radius: 20px;
      text-align: center;
      margin-bottom: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }
    
    .victory-title {
      font-size: 24px;
      font-weight: bold;
      color: #764ba2;
      margin-bottom: 10px;
    }
    
    .victory-text {
      font-size: 16px;
      color: #333;
    }
    
    /* –ê–ù–ò–ú–ê–¶–ò–ò –¢–ê–ù–¶–£–Æ–©–ï–ì–û –°–ò–õ–£–≠–¢–ê */
    @keyframes dance {
      0% { transform: translateX(0) rotate(0deg) scale(1); }
      25% { transform: translateX(-15px) rotate(-8deg) scale(1.05); }
      50% { transform: translateX(15px) rotate(8deg) scale(1.1); }
      75% { transform: translateX(-10px) rotate(-4deg) scale(1.05); }
      100% { transform: translateX(0) rotate(0deg) scale(1); }
    }
    
    @keyframes glow {
      0% { filter: brightness(1) drop-shadow(0 0 10px #ff0080); }
      25% { filter: brightness(1.3) drop-shadow(0 0 20px #00ff88); }
      50% { filter: brightness(1.5) drop-shadow(0 0 30px #0080ff); }
      75% { filter: brightness(1.3) drop-shadow(0 0 20px #ff0080); }
      100% { filter: brightness(1) drop-shadow(0 0 10px #00ff88); }
    }
    
    @keyframes colorShift {
      0% { filter: hue-rotate(0deg); }
      33% { filter: hue-rotate(120deg); }
      66% { filter: hue-rotate(240deg); }
      100% { filter: hue-rotate(360deg); }
    }
    
    .dancing-silhouette {
      animation: 
        dance 2s ease-in-out infinite,
        glow 3s ease-in-out infinite,
        colorShift 6s linear infinite;
    }
    
    /* –ö–û–ù–§–ï–¢–¢–ò */
    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      background: #ff0000;
      border-radius: 50%;
      animation: confetti-fall 3s linear forwards;
    }
    
    @keyframes confetti-fall {
      0% {
        transform: translateY(-100px) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }
    
    /* –≠–ù–ï–†–ì–ï–¢–ò–ß–ï–°–ö–ò–ï –í–û–õ–ù–´ */
    .energy-wave {
      position: absolute;
      border: 3px solid;
      border-radius: 50%;
      animation: energy-expand 2s ease-out;
      pointer-events: none;
    }
    
    @keyframes energy-expand {
      0% {
        transform: translate(-50%, -50%) scale(0.5);
        opacity: 1;
      }
      100% {
        transform: translate(-50%, -50%) scale(3);
        opacity: 0;
      }
    }
  </style>
</head>
<body>
  <!-- –õ–æ–∞–¥–µ—Ä -->
  <div id="loader" class="loader">
    <div>–ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä–µ–Ω–∞–∂—ë—Ä–∞...</div>
  </div>

  <!-- –ù–û–í–´–ô –≠–ö–†–ê–ù –ü–û–ë–ï–î–´ -->
  <div id="victoryScreen" class="victory-overlay">
    <div class="victory-message">
      <div class="victory-title">üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</div>
      <div class="victory-text">–í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏!</div>
    </div>
    <div class="game-area" style="border: none; background: transparent;">
      <img id="dancingSilhouette" src="person.png" alt="–¢–∞–Ω—Ü—É—é—â–∏–π —Å–∏–ª—É—ç—Ç" style="width: 100%; height: 100%; object-fit: contain;">
    </div>
  </div>

  <!-- –û—Å—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
  <div id="welcomeScreen" class="screen">
    <!-- ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ... -->
  </div>

  <div id="gameScreen" class="screen">
    <!-- ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ... -->
  </div>

  <div id="endScreen" class="screen">
    <!-- ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ... -->
  </div>

  <!-- –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç -->
  <audio id="backgroundMusic" loop preload="metadata">
    <source src="med.mp3" type="audio/mpeg">
  </audio>
  
  <!-- –ù–û–í–´–ô –ê–£–î–ò–û –î–õ–Ø –§–ê–ù–§–ê–† -->
  <audio id="victoryMusic" preload="metadata">
    <source src="fanfare.mp3" type="audio/mpeg">
  </audio>

  <canvas id="maskCanvas"></canvas>

  <script>
// –≠–ª–µ–º–µ–Ω—Ç—ã
const welcomeScreen = document.getElementById('welcomeScreen');
const gameScreen = document.getElementById('gameScreen');
const endScreen = document.getElementById('endScreen');
const victoryScreen = document.getElementById('victoryScreen');
const loader = document.getElementById('loader');
const dot = document.getElementById('dot');
const silhouette = document.getElementById('silhouette');
const dancingSilhouette = document.getElementById('dancingSilhouette');
const maskCanvas = document.getElementById('maskCanvas');
const status = document.getElementById('status');
const timerElement = document.getElementById('timer');
const soundBtn = document.getElementById('soundBtn');
const backgroundMusic = document.getElementById('backgroundMusic');
const victoryMusic = document.getElementById('victoryMusic');
const guidanceElement = document.getElementById('guidance');
const ctx = maskCanvas.getContext('2d');

// –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–≥—Ä—ã
let isMoving = false;
let maskData = null;
let gameTimer;
let timeLeft = 300;
let isMusicPlaying = false;
let wakeLock = null;
let inactivityTimer = null;

// –ù–û–í–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –î–õ–Ø –ê–ù–ò–ú–ê–¶–ò–ò
let victoryAnimationActive = false;
let confettiInterval = null;
let energyWaveInterval = null;

// –ù–∞—Å—Ç—Ä–æ–π–∫–∏
const MIN_STOP_TIME = 12000;
const MAX_STOP_TIME = 15000;
const GAME_DURATION = 300;
const VICTORY_DURATION = 10000; // 10 —Å–µ–∫—É–Ω–¥ –∞–Ω–∏–º–∞—Ü–∏–∏

// –¶–í–ï–¢–ê –î–õ–Ø –†–ê–ó–ù–´–• –ó–û–ù –¢–ï–õ–ê
const ZONE_COLORS = {
  '–Ω–æ–≥–∏': '#4ECDC4',     // –±–∏—Ä—é–∑–æ–≤—ã–π
  '—Ç–∞–∑': '#FF6B6B',      // –∫—Ä–∞—Å–Ω—ã–π
  '–∂–∏–≤–æ—Ç': '#FFD166',    // –∂–µ–ª—Ç—ã–π
  '–≥—Ä—É–¥—å': '#06D6A0',    // –∑–µ–ª–µ–Ω—ã–π
  '–≥–æ—Ä–ª–æ': '#118AB2',    // —Å–∏–Ω–∏–π
  '–ª–æ–±': '#9D4EDD',      // —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π
  '–º–∞–∫—É—à–∫–∞': '#FFFFFF'   // –±–µ–ª—ã–π
};

// –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ê–ù–ò–ú–ê–¶–ò–ò –ü–û–ë–ï–î–´
function startVictoryAnimation() {
  if (victoryAnimationActive) return;
  victoryAnimationActive = true;
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã
  victoryScreen.style.display = 'flex';
  
  // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–Ω—Ü—É—é—â–µ–≥–æ —Å–∏–ª—É—ç—Ç–∞
  dancingSilhouette.classList.add('dancing-silhouette');
  
  // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º —Ñ–∞–Ω—Ñ–∞—Ä—ã
  playVictoryMusic();
  
  // –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
  startConfetti();
  
  // –ó–∞–ø—É—Å–∫–∞–µ–º —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–ª–Ω—ã
  startEnergyWaves();
  
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∞–µ–º —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
  setTimeout(() => {
    endVictoryAnimation();
  }, VICTORY_DURATION);
}

function endVictoryAnimation() {
  victoryAnimationActive = false;
  
  // –°–∫—Ä—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –ø–æ–±–µ–¥—ã
  victoryScreen.style.display = 'none';
  
  // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏
  dancingSilhouette.classList.remove('dancing-silhouette');
  
  // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º—É–∑—ã–∫—É
  stopVictoryMusic();
  
  // –û—á–∏—â–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
  if (confettiInterval) {
    clearInterval(confettiInterval);
    confettiInterval = null;
  }
  
  if (energyWaveInterval) {
    clearInterval(energyWaveInterval);
    energyWaveInterval = null;
  }
  
  // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –æ–±—ã—á–Ω—ã–π —ç–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
  showEndScreen();
}

function playVictoryMusic() {
  if (victoryMusic) {
    victoryMusic.volume = 0.3;
    victoryMusic.play().catch(e => {
      console.log('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Ñ–∞–Ω—Ñ–∞—Ä—ã:', e);
    });
  }
}

function stopVictoryMusic() {
  if (victoryMusic) {
    victoryMusic.pause();
    victoryMusic.currentTime = 0;
  }
}

function startConfetti() {
  // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –∫–∞–∂–¥—ã–µ 200ms
  confettiInterval = setInterval(() => {
    createConfetti();
  }, 200);
}

function createConfetti() {
  const confetti = document.createElement('div');
  confetti.className = 'confetti';
  
  // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –≤–≤–µ—Ä—Ö—É —ç–∫—Ä–∞–Ω–∞
  const left = Math.random() * 100;
  confetti.style.left = left + '%';
  
  // –°–ª—É—á–∞–π–Ω—ã–π —Ü–≤–µ—Ç
  const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
  const color = colors[Math.floor(Math.random() * colors.length)];
  confetti.style.background = color;
  
  // –°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä
  const size = 5 + Math.random() * 10;
  confetti.style.width = size + 'px';
  confetti.style.height = size + 'px';
  
  // –°–ª—É—á–∞–π–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
  const duration = 2 + Math.random() * 2;
  confetti.style.animationDuration = duration + 's';
  
  victoryScreen.appendChild(confetti);
  
  // –£–¥–∞–ª—è–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
  setTimeout(() => {
    if (confetti.parentNode) {
      confetti.remove();
    }
  }, duration * 1000);
}

function startEnergyWaves() {
  // –°–æ–∑–¥–∞–µ–º —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–ª–Ω—ã –∫–∞–∂–¥—ã–µ 800ms
  energyWaveInterval = setInterval(() => {
    createEnergyWave();
  }, 800);
}

function createEnergyWave() {
  const wave = document.createElement('div');
  wave.className = 'energy-wave';
  
  // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –≤–æ–∫—Ä—É–≥ —Å–∏–ª—É—ç—Ç–∞
  wave.style.left = '50%';
  wave.style.top = '50%';
  
  // –°–ª—É—á–∞–π–Ω—ã–π —Ü–≤–µ—Ç
  const colors = ['#ff0080', '#00ff88', '#0080ff', '#ff8000'];
  const color = colors[Math.floor(Math.random() * colors.length)];
  wave.style.borderColor = color;
  
  victoryScreen.appendChild(wave);
  
  // –£–¥–∞–ª—è–µ–º –≤–æ–ª–Ω—É –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
  setTimeout(() => {
    if (wave.parentNode) {
      wave.remove();
    }
  }, 2000);
}

// –ú–û–î–ò–§–ò–¶–ò–†–û–í–ê–ù–ù–´–ï –§–£–ù–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –≠–ö–†–ê–ù–ê–ú–ò
function startGame() {
  welcomeScreen.classList.remove('active');
  gameScreen.classList.add('active');
  endScreen.classList.remove('active');
  victoryScreen.style.display = 'none';
  
  // –°–±—Ä–æ—Å –∏ –∑–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
  timeLeft = GAME_DURATION;
  updateTimer();
  clearInterval(gameTimer);
  gameTimer = setInterval(updateTimer, 1000);
  
  // –ó–∞–ø—É—Å–∫ –º—É–∑—ã–∫–∏
  startMusic();
  
  // –ó–∞–ø—É—Å–∫ –¥–≤–∏–∂–µ–Ω–∏—è —Ç–æ—á–∫–∏
  setTimeout(() => {
    moveToRandomPosition();
    startMoving();
  }, 500);
}

// –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ò–Ø –ò–ì–†–´ –° –ê–ù–ò–ú–ê–¶–ò–ï–ô
function endGame() {
  // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—ã—á–Ω—É—é –∏–≥—Ä—É
  gameScreen.classList.remove('active');
  stopMusic();
  clearInterval(gameTimer);
  stopMoving();
  
  // –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ Wake Lock
  if (wakeLock) {
    wakeLock.release().then(() => {
      wakeLock = null;
    });
  }
  
  // –°–±—Ä–æ—Å —Ç–æ—á–∫–∏
  dot.style.animation = 'none';
  dot.style.background = '#ff4444';
  
  // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø–æ–±–µ–¥—ã –≤–º–µ—Å—Ç–æ –æ–±—ã—á–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
  startVictoryAnimation();
}

// –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –û–ë–´–ß–ù–û–ì–û –≠–ö–†–ê–ù–ê –ó–ê–í–ï–†–®–ï–ù–ò–Ø (–±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–∏)
function showEndScreen() {
  endScreen.classList.add('active');
}

function restartGame() {
  endScreen.classList.remove('active');
  victoryScreen.style.display = 'none';
  welcomeScreen.classList.add('active');
  
  // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –∞–Ω–∏–º–∞—Ü–∏–∏
  victoryAnimationActive = false;
}

// –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
function onSilhouetteLoad() {
  maskCanvas.width = silhouette.naturalWidth || silhouette.width;
  maskCanvas.height = silhouette.naturalHeight || silhouette.height;
  createMask();
  status.textContent = '–°–ª–µ–¥–∏—Ç–µ –∑–∞ —Ç–æ—á–∫–æ–π...';
}

function onSilhouetteError() {
  status.textContent = '‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è';
  maskCanvas.width = 300;
  maskCanvas.height = 500;
  createMask();
}

// –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ detectBodyZone, createAttentionWave, changeDotAppearance, 
// startMusic, stopMusic, toggleMusic, createMask, isPointInSilhouette, 
// findValidPosition, moveToRandomPosition, startMoving, stopMoving, 
// updateTimer, sleep –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', function() {
  initializeApp();
});

function initializeApp() {
  setTimeout(() => {
    loader.style.display = 'none';
    welcomeScreen.classList.add('active');
  }, 1000);

  initializeWakeLock();
  setupActivityListeners();
  preloadAudio();
}

// –û—Å—Ç–∞–ª—å–Ω–æ–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥...
async function initializeWakeLock() {
  try {
    if ('wakeLock' in navigator) {
      wakeLock = await navigator.wakeLock.request('screen');
      console.log('Wake Lock –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω');
    }
  } catch (err) {
    console.log('Wake Lock –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è:', err);
  }
}

function setupActivityListeners() {
  const activityEvents = ['mousedown', 'mousemove', 'keypress', 'touchstart', 'touchmove', 'click'];
  activityEvents.forEach(event => {
    document.addEventListener(event, resetInactivityTimer, true);
  });
  resetInactivityTimer();
}

function resetInactivityTimer() {
  if (inactivityTimer) {
    clearTimeout(inactivityTimer);
  }
  
  if (gameScreen.classList.contains('active') && !isMoving) {
    startMoving();
  }
  
  inactivityTimer = setTimeout(() => {
    if (gameScreen.classList.contains('active')) {
      console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é...');
      startMoving();
    }
  }, 5000);
}

function preloadAudio() {
  if (backgroundMusic) {
    backgroundMusic.load();
  }
  if (victoryMusic) {
    victoryMusic.load();
  }
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('visibilitychange', function() {
  if (document.hidden) {
    if (isMusicPlaying && backgroundMusic) {
      backgroundMusic.pause();
    }
    if (victoryAnimationActive && victoryMusic) {
      victoryMusic.pause();
    }
  } else {
    if (isMusicPlaying && backgroundMusic) {
      backgroundMusic.play().catch(e => console.log('–ê–≤—Ç–æ–≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º—É–∑—ã–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ'));
    }
    if (victoryAnimationActive && victoryMusic) {
      victoryMusic.play().catch(e => console.log('–ê–≤—Ç–æ–≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–Ω—Ñ–∞—Ä –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ'));
    }
  }
});

// Telegram Web App
if (window.Telegram && Telegram.WebApp) {
  Telegram.WebApp.ready();
  Telegram.WebApp.expand();
  
  if (Telegram.WebApp.platform === 'ios') {
    Telegram.WebApp.disableVerticalSwipes();
  }
}

// –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ iOS
document.addEventListener('touchstart', function(e) {
  if (e.touches.length > 1) {
    e.preventDefault();
  }
}, { passive: false });

let lastTouchEnd = 0;
document.addEventListener('touchend', function(e) {
  const now = (new Date()).getTime();
  if (now - lastTouchEnd <= 300) {
    e.preventDefault();
  }
  lastTouchEnd = now;
}, false);
</script>

  <script>
// –£–ú–ù–û–ï –ö–ï–®–ò–†–û–í–ê–ù–ò–ï
const APP_VERSION = "1.1.0"; // –û–±–Ω–æ–≤–∏–ª –≤–µ—Ä—Å–∏—é –∏–∑-–∑–∞ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

function enableSmartCaching() {
    const resources = [
        ...document.querySelectorAll('link[rel="stylesheet"]'),
        ...document.querySelectorAll('script[src]'),
        ...document.querySelectorAll('img[src]')
    ];
    
    resources.forEach(resource => {
        const url = resource.src || resource.href;
        if (url && !url.includes('?') && !url.includes('cdn.')) {
            const newUrl = url.split('?')[0] + '?v=' + APP_VERSION;
            if (resource.src) resource.src = newUrl;
            if (resource.href) resource.href = newUrl;
        }
    });
}

document.addEventListener('DOMContentLoaded', enableSmartCaching);
</script>
